<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ULTRA CORE | TIKTOK EDITION</title>
    <style>
        :root {
            --accent: #00f2ff;
            --accent-glow: rgba(0, 242, 255, 0.3);
            --bg: #050505;
            --panel: rgba(20, 20, 20, 0.6);
            --border: rgba(255, 255, 255, 0.08);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', system-ui, sans-serif; }
        
        body { 
            background: var(--bg); 
            color: #fff; 
            height: 100vh; 
            overflow: hidden;
            background-image: radial-gradient(circle at 50% -20%, #003c4a, #050505);
        }

        /* –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ–Ω (–°–µ—Ç–∫–∞) */
        .bg-grid {
            position: fixed; inset: 0; z-index: -1;
            background-image: linear-gradient(var(--border) 1px, transparent 1px), linear-gradient(90deg, var(--border) 1px, transparent 1px);
            background-size: 50px 50px;
            transform: perspective(500px) rotateX(60deg) translateY(-100px);
            animation: gridMove 5s linear infinite;
        }
        @keyframes gridMove { from { background-position: 0 0; } to { background-position: 0 50px; } }

        /* –≠–ö–†–ê–ù –†–ï–ì–ò–°–¢–†–ê–¶–ò–ò */
        #auth-screen {
            position: fixed; inset: 0; z-index: 9999; background: var(--bg);
            display: flex; align-items: center; justify-content: center; transition: 1s;
        }
        .auth-card {
            background: var(--panel); backdrop-filter: blur(20px);
            padding: 50px; border-radius: 30px; border: 1px solid var(--border);
            width: 400px; text-align: center; box-shadow: 0 0 50px rgba(0,0,0,1);
        }
        .auth-card h1 { font-weight: 200; letter-spacing: 10px; margin-bottom: 30px; color: var(--accent); }
        .input-tg {
            width: 100%; padding: 15px; background: rgba(0,0,0,0.5);
            border: 1px solid var(--border); border-radius: 12px; color: #fff;
            margin-bottom: 20px; outline: none; transition: 0.3s;
        }
        .input-tg:focus { border-color: var(--accent); box-shadow: 0 0 15px var(--accent-glow); }
        .btn-neon {
            width: 100%; padding: 15px; background: var(--accent); color: #000;
            border: none; border-radius: 12px; font-weight: 900; cursor: pointer;
            text-transform: uppercase; box-shadow: 0 0 20px var(--accent-glow);
        }

        /* –ü–†–ò–í–ï–¢–°–¢–í–ò–ï –°–ù–ò–ó–£ */
        #welcome-popup {
            position: fixed; bottom: -100px; left: 50%; transform: translateX(-50%);
            background: var(--accent); color: #000; padding: 20px 40px;
            border-radius: 50px 50px 0 0; font-weight: 900; z-index: 10000;
            transition: 0.6s cubic-bezier(0.17, 0.89, 0.32, 1.2);
        }
        #welcome-popup.show { bottom: 0; }

        /* –ì–õ–ê–í–ù–´–ô –ò–ù–¢–ï–†–§–ï–ô–° (–¢–û–ß–¨-–í-–¢–û–ß–¨) */
        #app { display: grid; grid-template-columns: 80px 300px 1fr; height: 100vh; opacity: 0; transition: 1s; }
        
        /* –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å */
        .rail { background: rgba(0,0,0,0.8); border-right: 1px solid var(--border); display: flex; flex-direction: column; align-items: center; padding: 20px 0; }
        .r-item { width: 50px; height: 50px; border-radius: 15px; margin-bottom: 20px; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: 0.3s; }
        .r-item.active { background: var(--accent-glow); border: 1px solid var(--accent); color: var(--accent); }

        /* –°–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤ */
        .sidebar { background: rgba(10, 10, 10, 0.5); backdrop-filter: blur(15px); border-right: 1px solid var(--border); }
        .side-head { padding: 30px 20px; font-size: 12px; letter-spacing: 2px; color: var(--accent); font-weight: 900; }
        .chat-item { padding: 15px 25px; display: flex; align-items: center; gap: 15px; cursor: pointer; border-bottom: 1px solid var(--border); }
        .chat-item:hover { background: rgba(255,255,255,0.03); }
        .avatar { width: 45px; height: 45px; border-radius: 50%; background: var(--accent); display: flex; align-items: center; justify-content: center; color: #000; font-weight: 900; }

        /* –û–∫–Ω–æ —á–∞—Ç–∞ */
        .main-chat { display: flex; flex-direction: column; background: rgba(0,0,0,0.2); }
        .chat-head { height: 70px; border-bottom: 1px solid var(--border); padding: 0 30px; display: flex; align-items: center; justify-content: space-between; }
        
        #messages { flex: 1; overflow-y: auto; padding: 30px; display: flex; flex-direction: column; gap: 15px; }
        .bubble { 
            max-width: 60%; padding: 12px 20px; border-radius: 20px; font-size: 14px; 
            background: var(--panel); border: 1px solid var(--border); animation: msgSlide 0.4s ease;
        }
        .bubble.me { align-self: flex-end; border-color: var(--accent); background: var(--accent-glow); }
        @keyframes msgSlide { from { opacity: 0; transform: translateX(20px); } }

        .input-bar { padding: 25px 40px; }
        .input-box { background: rgba(255,255,255,0.03); border: 1px solid var(--border); border-radius: 15px; padding: 10px 20px; display: flex; align-items: center; gap: 15px; }
        #m-input { flex: 1; background: none; border: none; color: #fff; outline: none; }

        /* –ù–ê–°–¢–†–û–ô–ö–ò */
        #settings {
            position: fixed; left: -350px; top: 0; bottom: 0; width: 320px;
            background: #0a0a0a; z-index: 5000; padding: 40px; border-right: 2px solid var(--accent);
            transition: 0.5s cubic-bezier(0.8, 0, 0.2, 1);
        }
        #settings.open { left: 0; }
        .set-row { display: flex; justify-content: space-between; margin-bottom: 25px; align-items: center; }
        .sw { width: 40px; height: 20px; background: #333; border-radius: 20px; position: relative; cursor: pointer; }
        .sw.on { background: var(--accent); }
        .sw::after { content: ''; position: absolute; width: 16px; height: 16px; background: #fff; border-radius: 50%; top: 2px; left: 2px; transition: 0.2s; }
        .sw.on::after { left: 22px; }
    </style>
</head>
<body>

    <div class="bg-grid"></div>

    <div id="auth-screen">
        <div class="auth-card">
            <h1>ULTRA</h1>
            <input type="text" id="reg-name" class="input-tg" placeholder="–ò–ú–Ø –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø">
            <button class="btn-neon" onclick="startSystem()">–ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø</button>
        </div>
    </div>

    <div id="welcome-popup">–°–ò–°–¢–ï–ú–ê –ê–ö–¢–ò–í–ò–†–û–í–ê–ù–ê. –î–û–ë–†–û –ü–û–ñ–ê–õ–û–í–ê–¢–¨!</div>

    <div id="app">
        <nav class="rail">
            <div class="r-item active">üí¨</div>
            <div class="r-icon r-item" onclick="toggleSets()" style="font-size: 20px;">‚öôÔ∏è</div>
        </nav>

        <aside class="sidebar">
            <div class="side-head">–ê–ö–¢–ò–í–ù–´–ï –ö–ê–ù–ê–õ–´</div>
            <div class="chat-item">
                <div class="avatar">#</div>
                <div>
                    <div style="font-weight: 700;">main_core</div>
                    <div style="font-size: 11px; color: var(--accent);">–æ–Ω–ª–∞–π–Ω: <span id="online-count">0</span></div>
                </div>
            </div>
        </aside>

        <main class="main-chat">
            <header class="chat-head">
                <h3 style="letter-spacing: 2px;"># MAIN_CORE</h3>
                <div style="font-size: 10px; opacity: 0.5;">CRYPTO_PROTECTED</div>
            </header>
            <div id="messages"></div>
            <div class="input-bar">
                <form id="chat-form" class="input-box">
                    <input type="text" id="m-input" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." autocomplete="off">
                    <button type="submit" style="background:none; border:none; color:var(--accent); font-weight:900; cursor:pointer;">SEND</button>
                </form>
            </div>
        </main>
    </div>

    <div id="settings">
        <h2 style="margin-bottom: 40px; color: var(--accent);">SETTINGS</h2>
        <div class="set-row">
            <span>Grid Background</span>
            <div class="sw on" onclick="this.classList.toggle('on')"></div>
        </div>
        <div class="set-row">
            <span>Neon Effects</span>
            <div class="sw on" onclick="this.classList.toggle('on')"></div>
        </div>
        <button class="btn-neon" style="margin-top: 40px; background: #ff4444;" onclick="location.reload()">TERMINATE</button>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        let myName = "";

        function startSystem() {
            const name = document.getElementById('reg-name').value;
            if(!name) return;
            myName = name;

            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Ö–æ–¥
            document.getElementById('auth-screen').style.opacity = '0';
            setTimeout(() => document.getElementById('auth-screen').style.display = 'none', 1000);

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ —Å–Ω–∏–∑—É
            const pop = document.getElementById('welcome-popup');
            pop.classList.add('show');
            setTimeout(() => pop.classList.remove('show'), 3000);

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
            setTimeout(() => {
                document.getElementById('app').style.opacity = '1';
                socket.emit('authenticate', { username: myName });
            }, 800);
        }

        socket.on('update_online', count => {
            document.getElementById('online-count').innerText = count;
        });

        document.getElementById('chat-form').onsubmit = (e) => {
            e.preventDefault();
            const input = document.getElementById('m-input');
            if(input.value) {
                socket.emit('message', { text: input.value });
                input.value = '';
            }
        };

        socket.on('message', m => {
            const wrap = document.getElementById('messages');
            const isMe = m.name === myName;
            const div = document.createElement('div');
            div.className = `bubble ${isMe ? 'me' : ''}`;
            div.innerHTML = `
                <div style="font-size:10px; color:var(--accent); margin-bottom:5px;">${m.name}</div>
                ${m.text}
            `;
            wrap.appendChild(div);
            wrap.scrollTop = wrap.scrollHeight;
        });

        function toggleSets() { document.getElementById('settings').classList.toggle('open'); }
    </script>
</body>
</html>
