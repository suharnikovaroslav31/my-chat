<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ULTRA GLASS ELITE</title>
    <style>
        :root {
            --accent: #00d2ff;
            --accent-glow: rgba(0, 210, 255, 0.3);
            --glass: rgba(255, 255, 255, 0.03);
            --border: rgba(255, 255, 255, 0.08);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        body {
            font-family: 'Inter', -apple-system, sans-serif;
            background: #05070a; color: white;
            height: 100vh; overflow: hidden;
            display: flex; align-items: center; justify-content: center;
        }

        /* Живой фон с глубоким параллаксом */
        .bg-layer {
            position: fixed; inset: 0; z-index: -1;
            background: radial-gradient(circle at 20% 30%, #0a111a 0%, #05070a 100%);
        }
        .glow {
            position: absolute; width: 800px; height: 800px;
            background: radial-gradient(circle, rgba(0, 210, 255, 0.07) 0%, transparent 70%);
            filter: blur(120px); animation: move 25s infinite alternate ease-in-out;
        }
        @keyframes move { from { transform: translate(-20%, -20%); } to { transform: translate(20%, 20%); } }

        /* ОСНОВНОЙ КОНТЕЙНЕР */
        #main-app {
            display: none;
            width: 98vw; height: 96vh;
            background: var(--glass);
            backdrop-filter: blur(50px) saturate(200%);
            border: 1px solid var(--border);
            border-radius: 28px;
            display: grid;
            grid-template-columns: 280px 1fr 240px; /* Три панели теперь! */
            box-shadow: 0 50px 100px rgba(0,0,0,0.6);
        }

        /* ЛЕВАЯ ПАНЕЛЬ (КАНАЛЫ) */
        .sidebar-left { background: rgba(0,0,0,0.2); border-right: 1px solid var(--border); display: flex; flex-direction: column; }
        .nav-header { padding: 30px; font-weight: 900; letter-spacing: 2px; color: var(--accent); text-transform: uppercase; font-size: 14px; }
        .channel-item {
            padding: 14px 25px; margin: 2px 15px; border-radius: 12px;
            cursor: pointer; transition: 0.3s; color: #666; display: flex; align-items: center; gap: 12px;
        }
        .channel-item:hover { background: rgba(255,255,255,0.03); color: #fff; }
        .channel-item.active { background: var(--accent-glow); color: var(--accent); border: 1px solid rgba(0, 210, 255, 0.2); }

        /* ЦЕНТРАЛЬНЫЙ ЧАТ */
        .chat-area { display: flex; flex-direction: column; background: rgba(255,255,255,0.01); }
        .chat-header { padding: 20px 30px; border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; }
        
        #messages { flex: 1; padding: 30px; overflow-y: auto; display: flex; flex-direction: column; gap: 20px; }
        
        /* Сообщения */
        .msg-wrap { display: flex; gap: 15px; max-width: 80%; }
        .msg-wrap.mine { align-self: flex-end; flex-direction: row-reverse; }
        
        .avatar { width: 40px; height: 40px; border-radius: 12px; background: linear-gradient(45deg, var(--accent), #7000ff); flex-shrink: 0; }
        
        .bubble {
            padding: 15px 20px; border-radius: 20px;
            background: rgba(255,255,255,0.03); border: 1px solid var(--border);
            position: relative; line-height: 1.5;
        }
        .mine .bubble { background: var(--accent-glow); border-color: rgba(0, 210, 255, 0.4); }

        /* ПРАВАЯ ПАНЕЛЬ (ЛЮДИ) */
        .sidebar-right { background: rgba(0,0,0,0.2); border-left: 1px solid var(--border); padding: 25px; }
        .user-card { display: flex; align-items: center; gap: 12px; margin-bottom: 15px; opacity: 0.8; }
        .status-dot { width: 8px; height: 8px; background: #00ff88; border-radius: 50%; box-shadow: 0 0 10px #00ff88; }

        /* ВВОД */
        .input-wrap { padding: 30px; }
        #chat-form { 
            background: rgba(0,0,0,0.3); border: 1px solid var(--border); 
            padding: 10px 20px; border-radius: 20px; display: flex; gap: 15px; 
        }
        #msg-input { flex: 1; background: none; border: none; color: white; outline: none; font-size: 16px; }

        /* ЭКРАН ВХОДА (Изначально виден) */
        #auth-screen { position: fixed; inset: 0; z-index: 1000; background: #05070a; display: flex; align-items: center; justify-content: center; }
        .auth-card { background: rgba(15, 20, 30, 0.9); padding: 50px; border-radius: 32px; border: 1px solid var(--border); width: 400px; text-align: center; }
        .auth-card input { width: 100%; padding: 16px; margin-bottom: 15px; border-radius: 16px; border: 1px solid var(--border); background: #000; color: #fff; outline: none; }
        .auth-btn { width: 100%; padding: 16px; background: var(--accent); border: none; border-radius: 16px; font-weight: 800; cursor: pointer; }
    </style>
</head>
<body>
    <div class="bg-layer"><div class="glow"></div></div>

    <div id="auth-screen">
        <div class="auth-card">
            <h1 style="margin-bottom: 30px; letter-spacing: 5px;">ULTRA<span style="color:var(--accent)">PRO</span></h1>
            <input type="text" id="username" placeholder="Никнейм">
            <input type="password" id="password" placeholder="Пароль">
            <button class="auth-btn" onclick="handleAuth()">ВОЙТИ В СИСТЕМУ</button>
            <p style="margin-top: 20px; font-size: 12px; cursor: pointer; opacity: 0.5;" onclick="toggleReg()">Создать новый аккаунт</p>
        </div>
    </div>

    <div id="main-app" style="display: none;">
        <aside class="sidebar-left">
            <div class="nav-header">КАНАЛЫ</div>
            <div class="channel-item active"><span>#</span> основной-чат</div>
            <div class="channel-item"><span>#</span> идеи-проекта</div>
            <div class="channel-item"><span>#</span> медиа</div>
            <div style="margin-top: auto; padding: 25px; border-top: 1px solid var(--border);">
                <div style="display: flex; align-items: center; gap: 12px;">
                    <div class="avatar"></div>
                    <div id="user-tag" style="font-weight: 700;">User</div>
                </div>
            </div>
        </aside>

        <main class="chat-area">
            <header class="chat-header">
                <div><span style="opacity: 0.5;">#</span> <strong id="room-name">основной-чат</strong></div>
                <div style="font-size: 12px; color: #00ff88;">● 124 онлайн</div>
            </header>
            <div id="messages"></div>
            <div class="input-wrap">
                <form id="chat-form">
                    <input type="text" id="msg-input" placeholder="Написать сообщение..." autocomplete="off">
                    <button type="submit" style="background:none; border:none; color:var(--accent); font-weight:900; cursor:pointer;">ОТПРАВИТЬ</button>
                </form>
            </div>
        </main>

        <aside class="sidebar-right">
            <div style="font-size: 12px; font-weight: 800; color: #444; margin-bottom: 25px; letter-spacing: 1px;">В СЕТИ</div>
            <div id="online-list">
                <div class="user-card"><div class="status-dot"></div> <span>ярослав</span></div>
                <div class="user-card" style="opacity: 0.4;"><div class="status-dot" style="background:#444; box-shadow:none;"></div> <span>gemini_ai</span></div>
            </div>
        </aside>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        let isRegister = false;

        function toggleReg() {
            isRegister = !isRegister;
            document.querySelector('.auth-btn').innerText = isRegister ? 'ЗАРЕГИСТРИРОВАТЬСЯ' : 'ВОЙТИ В СИСТЕМУ';
        }

        function handleAuth() {
            const u = document.getElementById('username').value;
            const p = document.getElementById('password').value;
            if(u && p) socket.emit('authenticate', { username: u, password: p, isRegister });
        }

        socket.on('auth_success', d => {
            window.myNick = d.username;
            document.getElementById('auth-screen').style.display = 'none';
            document.getElementById('main-app').style.display = 'grid';
            document.getElementById('user-tag').innerText = d.username;
            socket.emit('join_room', 'основной-чат');
        });

        socket.on('message', m => {
            const wrap = document.createElement('div');
            const isMe = m.name === window.myNick;
            wrap.className = `msg-wrap ${isMe ? 'mine' : ''}`;
            wrap.innerHTML = `
                <div class="avatar" style="background:${isMe ? 'var(--accent)' : '#333'}"></div>
                <div class="bubble">
                    <small style="color:var(--accent); font-weight:800; font-size:10px;">${m.name}</small><br>
                    ${m.text}
                </div>
            `;
            document.getElementById('messages').appendChild(wrap);
            document.getElementById('messages').scrollTop = 99999;
        });

        document.getElementById('chat-form').onsubmit = (e) => {
            e.preventDefault();
            const i = document.getElementById('msg-input');
            if(i.value) {
                socket.emit('message', { name: window.myNick, text: i.value });
                i.value = '';
            }
        };
    </script>
</body>
</html>
