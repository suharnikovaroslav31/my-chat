<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ULTRA GLASS ELITE V2</title>
    <style>
        :root {
            --accent: #00d2ff;
            --accent-glow: rgba(0, 210, 255, 0.3);
            --glass: rgba(255, 255, 255, 0.03);
            --border: rgba(255, 255, 255, 0.1);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        body {
            background: #05070a; color: white;
            font-family: 'Inter', -apple-system, sans-serif;
            height: 100vh; overflow: hidden;
            display: flex; align-items: center; justify-content: center;
        }

        /* ЭФФЕКТ ТУМАННОСТИ (Живой фон) */
        .fog-container {
            position: fixed; inset: 0; z-index: -1;
            background: radial-gradient(circle at 50% 50%, #0a111a, #05070a);
        }
        .fog-blob {
            position: absolute; width: 600px; height: 600px;
            background: var(--accent); filter: blur(150px);
            opacity: 0.1; animation: fogMove 20s infinite alternate ease-in-out;
        }
        @keyframes fogMove {
            from { transform: translate(-10%, -10%) scale(1); }
            to { transform: translate(20%, 15%) scale(1.2); }
        }

        /* ПРИВЕТСТВИЕ */
        #welcome-overlay {
            position: fixed; inset: 0; z-index: 5000;
            background: #05070a; display: none;
            align-items: center; justify-content: center;
            font-size: 40px; font-weight: 900; letter-spacing: 5px;
            transition: opacity 1s ease;
        }

        /* ЭКРАН ВХОДА */
        #auth-screen {
            position: fixed; inset: 0; z-index: 1000;
            background: #05070a; display: flex; align-items: center; justify-content: center;
        }
        .auth-card {
            background: rgba(15, 20, 30, 0.8); backdrop-filter: blur(40px);
            padding: 50px; border-radius: 32px; border: 1px solid var(--border);
            width: 400px; text-align: center; box-shadow: 0 40px 100px rgba(0,0,0,0.5);
        }
        .auth-card input {
            width: 100%; padding: 16px; margin-bottom: 15px; border-radius: 16px;
            border: 1px solid var(--border); background: rgba(0,0,0,0.3); color: #fff; outline: none;
        }
        .auth-btn {
            width: 100%; padding: 16px; background: var(--accent); border: none;
            border-radius: 16px; font-weight: 800; cursor: pointer; color: #000;
        }

        /* ГЛАВНЫЙ ИНТЕРФЕЙС */
        #main-app {
            display: none; width: 98vw; height: 96vh;
            background: var(--glass); backdrop-filter: blur(50px);
            border: 1px solid var(--border); border-radius: 28px;
            grid-template-columns: 280px 1fr 240px;
        }

        .sidebar-left, .sidebar-right { background: rgba(0,0,0,0.2); border-right: 1px solid var(--border); display: flex; flex-direction: column; }
        .sidebar-right { border-left: 1px solid var(--border); border-right: none; padding: 25px; }

        .nav-header { padding: 30px; font-weight: 900; color: var(--accent); letter-spacing: 2px; font-size: 14px; }
        .channel-item { padding: 12px 25px; margin: 2px 15px; border-radius: 12px; cursor: pointer; color: #666; transition: 0.3s; }
        .channel-item.active { background: var(--accent-glow); color: var(--accent); }

        /* ЧАТ */
        .chat-area { display: flex; flex-direction: column; }
        #messages { flex: 1; padding: 30px; overflow-y: auto; display: flex; flex-direction: column; gap: 15px; }
        
        .bubble {
            padding: 12px 18px; border-radius: 18px;
            background: rgba(255,255,255,0.03); border: 1px solid var(--border);
            max-width: 75%; position: relative;
        }
        .msg-mine { align-self: flex-end; border-color: var(--accent-glow); background: rgba(0, 210, 255, 0.05); }

        .input-wrap { padding: 25px; }
        #chat-form { background: rgba(0,0,0,0.3); border: 1px solid var(--border); padding: 10px 20px; border-radius: 20px; display: flex; gap: 15px; }
        #msg-input { flex: 1; background: none; border: none; color: white; outline: none; }
    </style>
</head>
<body>

    <div class="fog-container">
        <div class="fog-blob" style="top: 20%; left: 10%;"></div>
        <div class="fog-blob" style="bottom: 10%; right: 10%; background: #7000ff;"></div>
    </div>

    <div id="welcome-overlay">DOBRO POZHALOVAT, <span id="welcome-name" style="color:var(--accent); margin-left: 15px;"></span></div>

    <div id="auth-screen">
        <div class="auth-card">
            <h1 style="margin-bottom: 30px;">ULTRA<span style="color:var(--accent)">PRO</span></h1>
            <input type="text" id="username" placeholder="Логин">
            <input type="password" id="password" placeholder="Пароль">
            <button class="auth-btn" onclick="handleAuth()">ВОЙТИ</button>
            <p onclick="toggleReg()" style="margin-top: 15px; font-size: 12px; cursor: pointer; opacity: 0.5;">Нет аккаунта? Создать</p>
        </div>
    </div>

    <div id="main-app">
        <aside class="sidebar-left">
            <div class="nav-header">КАНАЛЫ</div>
            <div class="channel-item active"># основной-чат</div>
            <div class="channel-item"># идеи-проекта</div>
            <div style="margin-top: auto; padding: 25px; border-top: 1px solid var(--border);">
                <div style="display: flex; align-items: center; gap: 12px; cursor: pointer;" onclick="alert('Открыть настройки?')">
                    <div style="width:40px; height:40px; border-radius:12px; background:var(--accent);"></div>
                    <div id="my-name-tag" style="font-weight: 700;">User</div>
                </div>
            </div>
        </aside>

        <main class="chat-area">
            <header style="padding: 20px 30px; border-bottom: 1px solid var(--border);"># основной-чат</header>
            <div id="messages"></div>
            <div class="input-wrap">
                <form id="chat-form">
                    <input type="text" id="msg-input" placeholder="Написать сообщение..." autocomplete="off">
                    <button type="submit" style="background:none; border:none; color:var(--accent); font-weight:800; cursor:pointer;">ОТПРАВИТЬ</button>
                </form>
            </div>
        </main>

        <aside class="sidebar-right">
            <div style="font-size: 12px; color: #444; margin-bottom: 20px; font-weight: 800;">В СЕТИ</div>
            <div style="display: flex; align-items: center; gap: 10px;">
                <div style="width: 8px; height: 8px; background: #00ff88; border-radius: 50%;"></div>
                <span>ярослав</span>
            </div>
        </aside>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        let isReg = false;

        function toggleReg() {
            isReg = !isReg;
            document.querySelector('.auth-btn').innerText = isReg ? 'РЕГИСТРАЦИЯ' : 'ВОЙТИ';
        }

        function handleAuth() {
            const u = document.getElementById('username').value;
            const p = document.getElementById('password').value;
            if(u && p) socket.emit('authenticate', { username: u, password: p, isRegister: isReg });
        }

        socket.on('auth_success', d => {
            window.myName = d.username;
            
            // Запуск приветствия
            document.getElementById('auth-screen').style.display = 'none';
            const welcome = document.getElementById('welcome-overlay');
            document.getElementById('welcome-name').innerText = d.username.toUpperCase();
            welcome.style.display = 'flex';
            
            setTimeout(() => {
                welcome.style.opacity = '0';
                setTimeout(() => {
                    welcome.style.display = 'none';
                    document.getElementById('main-app').style.display = 'grid';
                }, 1000);
            }, 2000);

            document.getElementById('my-name-tag').innerText = d.username;
            socket.emit('join_room', 'основной-чат');
        });

        socket.on('message', m => {
            const d = document.createElement('div');
            const isMe = m.name === window.myName;
            d.className = `bubble ${isMe ? 'msg-mine' : ''}`;
            d.innerHTML = `<small style="color:var(--accent); font-weight:800; font-size:10px;">${m.name}</small><br>${m.text}`;
            document.getElementById('messages').appendChild(d);
            document.getElementById('messages').scrollTop = 99999;
        });

        document.getElementById('chat-form').onsubmit = (e) => {
            e.preventDefault();
            const i = document.getElementById('msg-input');
            if(i.value) {
                socket.emit('message', { text: i.value });
                i.value = '';
            }
        };
    </script>
</body>
</html>
