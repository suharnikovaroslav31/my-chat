<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ULTRA CORE | NEXT GEN</title>
    <style>
        :root {
            --accent: #00d2ff;
            --accent-soft: rgba(0, 210, 255, 0.2);
            --bg: #020406;
            --glass: rgba(15, 20, 25, 0.7);
            --border: rgba(255, 255, 255, 0.07);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', system-ui, sans-serif; }
        
        body { 
            background: var(--bg); 
            color: #fff; 
            height: 100vh; 
            overflow: hidden; 
            /* –ñ–∏–≤–æ–π —Å–µ—Ä—å–µ–∑–Ω—ã–π —Ñ–æ–Ω */
            background: radial-gradient(circle at 50% 50%, #0a111a 0%, #020406 100%);
        }

        /* –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —á–∞—Å—Ç–∏—Ü—ã —Ñ–æ–Ω–∞ (Dark Nebula) */
        .nebula {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: url('https://www.transparenttextures.com/patterns/stardust.png');
            opacity: 0.1; animation: drift 60s linear infinite; pointer-events: none;
        }
        @keyframes drift { from { background-position: 0 0; } to { background-position: 1000px 1000px; } }

        /* –≠–∫—Ä–∞–Ω—ã */
        .screen { position: fixed; inset: 0; display: flex; align-items: center; justify-content: center; z-index: 1000; transition: 0.8s cubic-bezier(0.85, 0, 0.15, 1); background: var(--bg); }
        .hidden { opacity: 0; pointer-events: none; transform: translateY(-50px) scale(0.95); }

        /* –°–ï–†–¨–ï–ó–ù–ê–Ø –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø */
        .auth-card { background: var(--glass); backdrop-filter: blur(40px); border: 1px solid var(--border); padding: 50px; border-radius: 40px; width: 420px; text-align: center; box-shadow: 0 40px 100px rgba(0,0,0,0.8); }
        .auth-card h1 { font-size: 28px; letter-spacing: 5px; margin-bottom: 30px; font-weight: 200; }
        .profile-upload { width: 80px; height: 80px; background: var(--accent-soft); border-radius: 30px; margin: 0 auto 20px; border: 2px dashed var(--accent); display: flex; align-items: center; justify-content: center; font-size: 24px; }
        
        input { width: 100%; padding: 18px; margin-bottom: 15px; border-radius: 15px; border: 1px solid var(--border); background: rgba(0,0,0,0.3); color: #fff; font-size: 16px; transition: 0.3s; }
        input:focus { border-color: var(--accent); box-shadow: 0 0 20px var(--accent-soft); outline: none; }
        .main-btn { width: 100%; padding: 18px; background: var(--accent); color: #000; border: none; border-radius: 15px; font-weight: 900; cursor: pointer; letter-spacing: 1px; }

        /* –ü–†–ò–í–ï–¢–°–¢–í–ò–ï */
        #welcome-screen .content { text-align: center; max-width: 600px; }
        .feature-list { text-align: left; margin: 30px 0; display: grid; gap: 15px; }
        .feat { display: flex; align-items: center; gap: 15px; opacity: 0; transform: translateY(20px); animation: fadeUp 0.5s forwards; }
        @keyframes fadeUp { to { opacity: 1; transform: translateY(0); } }

        /* –ì–õ–ê–í–ù–´–ô –ò–ù–¢–ï–†–§–ï–ô–° (TG STYLE) */
        #app { display: grid; grid-template-columns: 80px 300px 1fr; width: 100vw; height: 100vh; z-index: 10; position: relative; }

        /* –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å –∏–∫–æ–Ω–æ–∫ */
        .rail { background: rgba(0,0,0,0.4); border-right: 1px solid var(--border); display: flex; flex-direction: column; align-items: center; padding: 25px 0; gap: 20px; }
        .r-icon { width: 50px; height: 50px; border-radius: 18px; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: 0.3s; font-size: 20px; }
        .r-icon:hover { background: var(--accent-soft); color: var(--accent); }
        .r-icon.active { background: var(--accent); color: #000; box-shadow: 0 10px 20px rgba(0,210,255,0.3); }

        /* –°–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤ */
        .chat-list { background: rgba(5, 8, 15, 0.3); border-right: 1px solid var(--border); }
        .search-box { padding: 25px 20px; }
        .chat-item { padding: 15px 20px; display: flex; gap: 15px; align-items: center; cursor: pointer; transition: 0.2s; border-radius: 15px; margin: 2px 10px; }
        .chat-item:hover { background: rgba(255,255,255,0.03); }
        .chat-item.active { background: var(--accent-soft); }
        .avatar { width: 45px; height: 45px; border-radius: 15px; background: var(--accent); flex-shrink: 0; }

        /* –û–∫–Ω–æ —á–∞—Ç–∞ */
        .viewport { display: flex; flex-direction: column; background: rgba(0,0,0,0.2); }
        .v-header { height: 75px; border-bottom: 1px solid var(--border); display: flex; align-items: center; padding: 0 30px; justify-content: space-between; }
        
        #msg-flow { flex: 1; overflow-y: auto; padding: 30px; display: flex; flex-direction: column; gap: 15px; }
        .bubble { padding: 14px 20px; border-radius: 22px; background: var(--glass); border: 1px solid var(--border); max-width: 65%; position: relative; animation: popIn 0.4s cubic-bezier(0.17, 0.89, 0.32, 1.49); }
        .bubble.me { align-self: flex-end; border-color: var(--accent-soft); background: rgba(0,210,255,0.05); }
        @keyframes popIn { from { transform: scale(0.8) translateY(20px); opacity: 0; } }

        .v-input { padding: 30px; }
        .i-box { background: rgba(255,255,255,0.03); border: 1px solid var(--border); border-radius: 20px; padding: 10px 25px; display: flex; align-items: center; }
        #main-input { flex: 1; background: none; border: none; color: #fff; padding: 10px 0; outline: none; font-size: 16px; }

        /* –ù–ê–°–¢–†–û–ô–ö–ò (TG STYLE SIDEBAR) */
        #settings-panel {
            position: fixed; left: -400px; top: 0; bottom: 0; width: 380px; 
            background: #0a0f18; z-index: 2000; border-right: 1px solid var(--border);
            transition: 0.5s cubic-bezier(0.8, 0, 0.2, 1); padding: 40px;
        }
        #settings-panel.open { left: 0; box-shadow: 50px 0 100px rgba(0,0,0,0.9); }
    </style>
</head>
<body>

    <div class="nebula"></div>

    <div id="screen-auth" class="screen">
        <div class="auth-card">
            <h1>ULTRA CORE</h1>
            <div class="profile-upload">üë§</div>
            <input type="text" id="reg-name" placeholder="–í–∞—à–µ —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –∏–º—è">
            <input type="text" id="reg-bio" placeholder="–û —Å–µ–±–µ (–∫—Ä–∞—Ç–∫–æ)">
            <input type="password" id="reg-pass" placeholder="–°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á (–ø–∞—Ä–æ–ª—å)">
            <button class="main-btn" onclick="startOnboarding()">–°–û–ó–î–ê–¢–¨ –ü–†–û–§–ò–õ–¨</button>
        </div>
    </div>

    <div id="screen-welcome" class="screen hidden">
        <div class="content">
            <h1 style="font-size: 40px; margin-bottom: 20px;">–î–û–ë–†–û –ü–û–ñ–ê–õ–û–í–ê–¢–¨</h1>
            <p style="opacity: 0.5;">–í–∞—à –ø—Ä–æ—Ñ–∏–ª—å <b id="user-display" style="color: var(--accent);"></b> —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω –≤ —Å–µ—Ç–∏ ULTRA.</p>
            
            <div class="feature-list">
                <div class="feat" style="animation-delay: 0.2s;"><span>üíé</span> <b>Glass UI:</b> –í–µ—Å—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ —ç—Ñ—Ñ–µ–∫—Ç–µ –º–∞—Ç–æ–≤–æ–≥–æ —Å—Ç–µ–∫–ª–∞.</div>
                <div class="feat" style="animation-delay: 0.4s;"><span>üîí</span> <b>Private:</b> –í–∞—à–∏ —Å–æ–æ–±—â–µ–Ω–∏—è —à–∏—Ñ—Ä—É—é—Ç—Å—è –Ω–∞ –ª–µ—Ç—É.</div>
                <div class="feat" style="animation-delay: 0.6s;"><span>‚ö°</span> <b>Engine v3:</b> –ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ —á–µ—Ä–µ–∑ —è–¥—Ä–æ Node.js.</div>
            </div>

            <button class="main-btn" onclick="enterApp()">–í–û–ô–¢–ò –í –°–ò–°–¢–ï–ú–£</button>
        </div>
    </div>

    <div id="app" class="hidden">
        <nav class="rail">
            <div class="r-icon active">üí¨</div>
            <div class="r-icon" onclick="toggleSettings()">‚öôÔ∏è</div>
            <div class="r-icon" style="margin-top: auto;">üö™</div>
        </nav>

        <aside class="chat-list">
            <div class="search-box">
                <input type="text" placeholder="–ü–æ–∏—Å–∫ —á–∞—Ç–æ–≤..." style="margin-bottom: 0; padding: 12px; font-size: 14px;">
            </div>
            <div class="chat-item active">
                <div class="avatar"></div>
                <div>
                    <div style="font-weight: 700;"># –æ—Å–Ω–æ–≤–Ω–æ–π-—á–∞—Ç</div>
                    <div style="font-size: 12px; opacity: 0.4;">–í —Å–µ—Ç–∏: 124 —á–µ–ª.</div>
                </div>
            </div>
            <div class="chat-item">
                <div class="avatar" style="background: #ff00d2;"></div>
                <div>
                    <div style="font-weight: 700;"># dev-logs</div>
                    <div style="font-size: 12px; opacity: 0.4;">–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ v3.0...</div>
                </div>
            </div>
        </aside>

        <main class="viewport">
            <header class="v-header">
                <div>
                    <h3 id="current-ch"># –æ—Å–Ω–æ–≤–Ω–æ–π-—á–∞—Ç</h3>
                    <p style="font-size: 11px; color: #00ff88;">‚óè —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ</p>
                </div>
                <div style="font-size: 12px; opacity: 0.4;">v3.0 Stable</div>
            </header>

            <div id="msg-flow"></div>

            <form class="v-input" id="chat-form">
                <div class="i-box">
                    <input type="text" id="main-input" placeholder="–ù–∞–ø–∏—Å–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ..." autocomplete="off">
                    <button type="submit" style="background:none; border:none; color:var(--accent); font-weight:900; cursor:pointer;">SEND</button>
                </div>
            </form>
        </main>
    </div>

    <div id="settings-panel">
        <h2 style="margin-bottom: 30px;">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
        <div style="text-align: center; margin-bottom: 40px;">
            <div style="width: 100px; height: 100px; background: var(--accent); border-radius: 35px; margin: 0 auto 15px;"></div>
            <h3 id="set-name">User</h3>
            <p id="set-bio" style="font-size: 13px; opacity: 0.5;"></p>
        </div>

        <div style="display: grid; gap: 10px;">
            <div class="chat-item">üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è: –í–∫–ª</div>
            <div class="chat-item">üé® –¢–µ–º–∞: Dark Nebula</div>
            <div class="chat-item">üîí –ü—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å: –í—ã—Å–æ–∫–∞—è</div>
        </div>

        <button class="main-btn" style="margin-top: 50px; background: rgba(255,0,0,0.1); color: #ff4444;" onclick="toggleSettings()">–ó–ê–ö–†–´–¢–¨</button>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        let user = { name: '', bio: '' };

        function startOnboarding() {
            const name = document.getElementById('reg-name').value;
            const bio = document.getElementById('reg-bio').value;
            if(!name) return alert("–í–≤–µ–¥–∏—Ç–µ –∏–º—è!");
            
            user.name = name;
            user.bio = bio;

            document.getElementById('screen-auth').classList.add('hidden');
            setTimeout(() => {
                document.getElementById('user-display').innerText = name.toUpperCase();
                document.getElementById('screen-welcome').classList.remove('hidden');
            }, 800);
        }

        function enterApp() {
            document.getElementById('screen-welcome').classList.add('hidden');
            setTimeout(() => {
                document.getElementById('app').classList.remove('hidden');
                document.getElementById('set-name').innerText = user.name;
                document.getElementById('set-bio').innerText = user.bio;
                socket.emit('authenticate', { username: user.name, password: '123', isRegister: true });
            }, 800);
        }

        function toggleSettings() {
            document.getElementById('settings-panel').classList.toggle('open');
        }

        // –õ–æ–≥–∏–∫–∞ —á–∞—Ç–∞
        document.getElementById('chat-form').onsubmit = (e) => {
            e.preventDefault();
            const inp = document.getElementById('main-input');
            if(inp.value) {
                socket.emit('message', { text: inp.value });
                inp.value = '';
            }
        };

        socket.on('message', m => {
            const flow = document.getElementById('msg-flow');
            const div = document.createElement('div');
            const isMe = m.name === user.name;
            div.className = `bubble ${isMe ? 'me' : ''}`;
            div.innerHTML = `<small style="color:var(--accent); font-weight:800; font-size:10px;">${m.name}</small><br>${m.text}`;
            flow.appendChild(div);
            flow.scrollTop = flow.scrollHeight;
        });
    </script>
</body>
</html>
