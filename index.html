<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Speeky Messenger | Absolute Edition</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --accent: #00f2ff;
            --accent-glow: rgba(0, 242, 255, 0.4);
            --bg: #010204;
            --glass-strong: rgba(15, 18, 22, 0.98);
            --glass-light: rgba(255, 255, 255, 0.03);
            --border: rgba(255, 255, 255, 0.07);
            --text-main: #ffffff;
            --text-dim: rgba(255, 255, 255, 0.5);
            --ease: cubic-bezier(0.16, 1, 0.3, 1);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; }
        body { background: var(--bg); color: var(--text-main); height: 100vh; overflow: hidden; position: relative; }

        /* --- –≠–§–§–ï–ö–¢ –û–ë–õ–ê–ö–û–í –ü–û –í–û–î–ï (–ë–≠–ö–ì–†–ê–£–ù–î) --- */
        #ether-bg {
            position: fixed; inset: 0; z-index: -1;
            background: radial-gradient(circle at 50% 100%, #001a1d 0%, #000 70%);
        }
        .cloud {
            position: absolute; width: 150vw; height: 150vw;
            background: radial-gradient(circle, rgba(0, 242, 255, 0.05) 0%, transparent 60%);
            filter: blur(100px); opacity: 0.5;
            animation: drift 40s infinite alternate ease-in-out;
        }
        .cloud:nth-child(2) { top: -20%; left: -20%; animation-delay: -10s; }
        .cloud:nth-child(3) { bottom: -20%; right: -20%; background: radial-gradient(circle, rgba(112, 0, 255, 0.03) 0%, transparent 60%); animation-delay: -20s; }
        @keyframes drift {
            from { transform: translate(-10%, -10%) rotate(0deg) scale(1); }
            to { transform: translate(10%, 10%) rotate(15deg) scale(1.1); }
        }

        /* --- –í–ï–†–•–ù–ò–ô –û–°–¢–†–û–í–û–ö (LIVE STATS) --- */
        .island-top {
            position: fixed; top: 12px; left: 50%; transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.85); border: 1px solid var(--border);
            padding: 6px 14px; border-radius: 20px; backdrop-filter: blur(20px);
            display: flex; align-items: center; gap: 8px; z-index: 1000;
        }
        .live-dot { width: 6px; height: 6px; background: var(--accent); border-radius: 50%; box-shadow: 0 0 8px var(--accent); }
        .live-label { font-size: 10px; font-weight: 800; text-transform: uppercase; letter-spacing: 1.5px; opacity: 0.8; }

        /* --- –°–¢–†–£–ö–¢–£–†–ê –ü–õ–ê–í–ù–û–°–¢–ò --- */
        .screen {
            position: absolute; inset: 0; padding: 80px 25px 120px;
            display: none; flex-direction: column; opacity: 0;
            transform: scale(0.98) translateY(20px); filter: blur(15px);
            transition: all 0.8s var(--ease);
        }
        .screen.active { display: flex; opacity: 1; transform: scale(1) translateY(0); filter: blur(0px); }

        /* --- –°–ï–†–¨–ï–ó–ù–´–ô –í–•–û–î/–†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø [cite: 2026-02-23] --- */
        .auth-container {
            max-width: 420px; width: 100%; margin: auto;
            background: var(--glass-strong); border: 1px solid var(--border);
            border-radius: 40px; padding: 45px; backdrop-filter: blur(50px);
            box-shadow: 0 50px 100px rgba(0,0,0,0.6);
        }
        .auth-title { font-size: 34px; font-weight: 800; margin-bottom: 8px; letter-spacing: -1.2px; }
        .auth-subtitle { font-size: 14px; color: var(--text-dim); margin-bottom: 35px; }

        .input-box { position: relative; margin-bottom: 18px; }
        .input-box input {
            width: 100%; background: var(--glass-light); border: 1px solid var(--border);
            padding: 20px 24px; border-radius: 22px; color: #fff; font-size: 16px;
            transition: 0.3s var(--ease);
        }
        .input-box input:focus {
            background: rgba(255,255,255,0.06); border-color: var(--accent);
            box-shadow: 0 0 25px var(--accent-soft);
        }

        .btn-elite {
            width: 100%; padding: 20px; background: var(--accent); color: #000;
            border: none; border-radius: 22px; font-weight: 800; font-size: 15px;
            text-transform: uppercase; cursor: pointer; transition: 0.4s var(--ease);
            box-shadow: 0 10px 30px var(--accent-glow); margin-top: 10px;
        }
        .btn-elite:active { transform: scale(0.97); }

        /* --- –ò–ù–¢–ï–†–§–ï–ô–° –ú–ï–°–°–ï–ù–î–ñ–ï–†–ê --- */
        .header-flex { display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 30px; }
        .section-title { font-size: 38px; font-weight: 800; letter-spacing: -1px; }
        .search-trigger {
            width: 48px; height: 48px; border-radius: 50%; background: var(--glass-light);
            border: 1px solid var(--border); display: flex; align-items: center; justify-content: center;
            font-size: 20px; cursor: pointer; transition: 0.3s;
        }

        .chat-row {
            background: var(--glass-light); border: 1px solid var(--border);
            border-radius: 28px; padding: 20px; margin-bottom: 12px;
            display: flex; align-items: center; gap: 16px;
            cursor: pointer; transition: 0.3s var(--ease);
        }
        .chat-row:active { transform: scale(0.98); background: rgba(255,255,255,0.06); }
        .chat-avatar {
            width: 54px; height: 54px; border-radius: 18px;
            background: linear-gradient(135deg, #00f2ff, #7000ff);
            display: flex; align-items: center; justify-content: center; font-weight: 800;
        }

        /* --- –ü–û–¢–û–ö –°–û–û–ë–©–ï–ù–ò–ô [cite: 2026-02-25] --- */
        #chat-flow { flex: 1; display: flex; flex-direction: column; gap: 14px; overflow-y: auto; padding: 20px 0; }
        .bubble {
            max-width: 78%; padding: 16px 20px; border-radius: 24px;
            font-size: 15px; line-height: 1.5; animation: bubbleIn 0.6s var(--ease);
        }
        @keyframes bubbleIn { from { opacity: 0; transform: translateY(20px) scale(0.9); } to { opacity: 1; transform: translateY(0) scale(1); } }
        .bubble.me { align-self: flex-end; background: var(--accent); color: #000; font-weight: 600; border-bottom-right-radius: 4px; }
        .bubble.he { align-self: flex-start; background: var(--glass-light); border: 1px solid var(--border); border-bottom-left-radius: 4px; }

        /* --- –ù–ò–ñ–ù–ò–ô –ú–ê–õ–ï–ù–¨–ö–ò–ô –û–°–¢–†–û–í --- */
        .island-bottom {
            position: fixed; bottom: 25px; left: 50%; transform: translateX(-50%);
            background: rgba(10, 12, 15, 0.95); border: 1px solid var(--border);
            padding: 10px 30px; border-radius: 35px; backdrop-filter: blur(30px);
            display: flex; gap: 40px; z-index: 1000; box-shadow: 0 20px 50px rgba(0,0,0,0.5);
        }
        .nav-link { font-size: 24px; opacity: 0.3; cursor: pointer; transition: 0.4s var(--ease); }
        .nav-link.active { opacity: 1; color: var(--accent); transform: scale(1.2); }

        /* –í–í–û–î –°–û–û–ë–©–ï–ù–ò–Ø */
        .input-area {
            position: fixed; bottom: 90px; left: 50%; transform: translateX(-50%);
            width: 90%; max-width: 450px; display: none; align-items: center;
            background: var(--glass-strong); border: 1px solid var(--border);
            padding: 8px; border-radius: 30px; backdrop-filter: blur(40px);
        }
        .input-area.active { display: flex; animation: bubbleIn 0.5s var(--ease); }
        .input-area input { flex: 1; background: transparent; border: none; padding: 12px 20px; color: #fff; font-size: 15px; }
        .send-btn { width: 45px; height: 45px; background: var(--accent); border: none; border-radius: 50%; cursor: pointer; font-size: 18px; }

    </style>
</head>
<body>

    <div id="ether-bg"><div class="cloud"></div><div class="cloud"></div><div class="cloud"></div></div>

    <div class="island-top">
        <div class="live-dot"></div>
        <span class="live-label">System Active ‚Ä¢ <span id="online-count">1</span> online</span>
    </div>

    <section id="view-auth" class="screen">
        <div class="auth-container">
            <h1 class="auth-title">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å</h1>
            <p class="auth-subtitle">–í–æ–π–¥–∏—Ç–µ –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –∞–∫–∫–∞—É–Ω—Ç</p>
            <div class="input-box">
                <input type="text" id="in-name" placeholder="@username">
            </div>
            <div class="input-box">
                <input type="email" id="in-email" placeholder="Email –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è">
            </div>
            <button class="btn-elite" onclick="sysLogin()">–ù–∞—á–∞—Ç—å –æ–±—â–µ–Ω–∏–µ</button>
        </div>
    </section>

    <section id="view-chats" class="screen">
        <div class="header-flex">
            <h1 class="section-title">–ß–∞—Ç—ã</h1>
            <div class="search-trigger" onclick="searchUser()">üîç</div>
        </div>
        <div id="contacts-list"></div>
    </section>

    <section id="view-room" class="screen">
        <div style="display:flex; align-items:center; gap:15px; margin-bottom:20px;">
            <div onclick="navTo('chats')" style="cursor:pointer; opacity:0.5; font-size: 20px;">‚Üê</div>
            <h2 id="peer-name" style="font-size:20px; font-weight:700;">@username</h2>
        </div>
        <div id="chat-flow"></div>
    </section>

    <section id="view-sets" class="screen">
        <h1 class="section-title" style="margin-bottom:30px;">–ü—Ä–æ—Ñ–∏–ª—å</h1>
        <div class="auth-container" style="max-width:100%; text-align:left; padding:30px;">
            <p style="font-size:10px; opacity:0.3; margin-bottom:8px; letter-spacing:2px;">–õ–ò–ß–ù–´–ï –î–ê–ù–ù–´–ï</p>
            <h3 id="u-n" style="font-size:28px; color:var(--accent); margin-bottom:5px;">@...</h3>
            <p id="u-e" style="opacity:0.5; margin-bottom:25px;">...</p>
            
            <div style="background:rgba(255,255,255,0.02); padding:20px; border-radius:25px; border:1px solid var(--border);">
                <span style="font-size:12px; opacity:0.4;">–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:</span>
                <p id="u-d" style="font-size:14px; margin-top:5px;">...</p>
            </div>
            
            <button onclick="sysLogout()" style="margin-top:40px; color:#ff4d4d; background:none; border:none; font-weight:800; cursor:pointer; width:100%;">–í–´–ô–¢–ò –ò–ó –ê–ö–ö–ê–£–ù–¢–ê</button>
        </div>
    </section>

    <div id="msg-input-hub" class="input-area">
        <input type="text" id="msg-val" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." onkeypress="if(event.key==='Enter') pushMsg()">
        <button class="send-btn" onclick="pushMsg()">‚ûî</button>
    </div>

    <div class="island-bottom" id="nav-hub" style="display:none;">
        <div class="nav-link active" id="btn-chats" onclick="navTo('chats')">üí¨</div>
        <div class="nav-link" id="btn-sets" onclick="navTo('sets')">‚öôÔ∏è</div>
    </div>

    <script>
        const API = 'https://my-chat-itp3.onrender.com/messages';
        const STORAGE = 'SPEEKY_ELITE_PRO';
        let user = JSON.parse(localStorage.getItem(STORAGE));
        let peer = null;
        let lastHash = "";

        function sysLogin() {
            const n = document.getElementById('in-name').value.trim().replace('@','');
            const e = document.getElementById('in-email').value.trim();
            if(!n || !e) return;
            user = { name: n, email: e, date: new Date().toLocaleDateString(), id: 'ID'+Math.floor(Math.random()*1000) };
            localStorage.setItem(STORAGE, JSON.stringify(user));
            location.reload();
        }

        function navTo(page) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            setTimeout(() => { document.getElementById('view-' + page).classList.add('active'); }, 50);
            
            document.getElementById('msg-input-hub').classList.toggle('active', page === 'room');
            document.getElementById('nav-hub').style.display = (page === 'auth') ? 'none' : 'flex';
            
            document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
            const link = document.getElementById('btn-' + (page === 'room' ? 'chats' : page));
            if(link) link.classList.add('active');
        }

        function searchUser() {
            const p = prompt("–ù–∏–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:");
            if(p) { peer = p.replace('@',''); document.getElementById('peer-name').innerText = '@' + peer; navTo('room'); sync(); }
        }

        async function pushMsg() {
            const i = document.getElementById('msg-val');
            if(!i.value.trim() || !peer) return;
            const text = i.value; i.value = '';
            await fetch(API, { method: 'POST', headers: {'Content-Type':'application/json'}, body: JSON.stringify({ from: user.name, to: peer, text, time: Date.now() }) });
            sync();
        }

        async function sync() {
            try {
                const r = await fetch(API); const d = await r.json();
                const hash = JSON.stringify(d.slice(-5));
                if(hash === lastHash) return; lastHash = hash;

                if(peer) {
                    const flow = document.getElementById('chat-flow'); flow.innerHTML = '';
                    d.filter(m => (m.from === user.name && m.to === peer) || (m.from === peer && m.to === user.name))
                     .forEach(m => {
                        const b = document.createElement('div');
                        b.className = `bubble ${m.from === user.name ? 'me' : 'he'}`;
                        b.innerText = m.text; flow.appendChild(b);
                     });
                    flow.scrollTop = flow.scrollHeight;
                }

                const chats = new Set(); d.forEach(m => { if(m.from === user.name) chats.add(m.to); if(m.to === user.name) chats.add(m.from); });
                const list = document.getElementById('contacts-list'); list.innerHTML = '';
                chats.forEach(c => {
                    const row = document.createElement('div'); row.className = 'chat-row';
                    row.innerHTML = `<div class="chat-avatar">${c[0].toUpperCase()}</div><div><b style="font-size:18px;">@${c}</b><p style="font-size:12px; opacity:0.3; margin-top:4px;">Secure connection active</p></div>`;
                    row.onclick = () => { peer = c; document.getElementById('peer-name').innerText = '@' + c; navTo('room'); };
                    list.appendChild(row);
                });
                document.getElementById('online-count').innerText = Math.floor(Math.random() * 5) + 1;
            } catch(e) {}
        }

        if(user) {
            document.getElementById('u-n').innerText = '@' + user.name;
            document.getElementById('u-e').innerText = user.email;
            document.getElementById('u-d').innerText = user.date;
            navTo('chats'); setInterval(sync, 2500); sync();
        } else { navTo('auth'); }

        function sysLogout() { localStorage.removeItem(STORAGE); location.reload(); }
    </script>
</body>
</html>
