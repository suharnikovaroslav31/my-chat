<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ULTRA MOBILE</title>
    <style>
        :root {
            --accent: #00f2ff;
            --bg: #050505;
            --panel: rgba(25, 25, 25, 0.9);
            --border: rgba(0, 242, 255, 0.2);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; }
        
        body { background: var(--bg); color: #fff; height: 100vh; overflow: hidden; position: fixed; width: 100%; }

        /* –ñ–∏–≤–æ–π —Ñ–æ–Ω (–°–µ—Ç–∫–∞ –¥–ª—è –º–æ–±–∏–ª–æ–∫ –ø–æ–ª–µ–≥—á–µ) */
        .grid {
            position: fixed; inset: 0; z-index: -1;
            background-image: linear-gradient(var(--border) 1px, transparent 1px), linear-gradient(90deg, var(--border) 1px, transparent 1px);
            background-size: 40px 40px;
            transform: perspective(300px) rotateX(60deg) translateY(-50px);
            animation: move 4s linear infinite;
        }
        @keyframes move { from { background-position: 0 0; } to { background-position: 0 40px; } }

        /* –≠–ö–†–ê–ù –í–•–û–î–ê */
        #auth-screen {
            position: fixed; inset: 0; z-index: 1000; background: var(--bg);
            display: flex; align-items: center; justify-content: center; padding: 30px;
        }
        .auth-card {
            width: 100%; max-width: 320px; text-align: center;
            background: var(--panel); padding: 40px 25px; border-radius: 30px; border: 1px solid var(--border);
        }
        .input-m {
            width: 100%; padding: 18px; background: #000; border: 1px solid var(--border);
            border-radius: 15px; color: #fff; margin-bottom: 20px; outline: none; font-size: 16px;
        }
        .btn-m {
            width: 100%; padding: 18px; background: var(--accent); color: #000;
            border: none; border-radius: 15px; font-weight: 900; font-size: 14px; letter-spacing: 2px;
        }

        /* –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ô–ù–ï–† */
        #app { height: 100vh; display: flex; flex-direction: column; opacity: 0; transition: 0.5s; }

        /* –®–ê–ü–ö–ê */
        .header {
            height: 70px; display: flex; align-items: center; padding: 0 20px;
            background: var(--panel); backdrop-filter: blur(20px); border-bottom: 1px solid var(--border);
            justify-content: space-between;
        }
        .status-dot { width: 8px; height: 8px; background: var(--accent); border-radius: 50%; display: inline-block; margin-right: 5px; box-shadow: 0 0 10px var(--accent); }

        /* –°–ü–ò–°–û–ö –ß–ê–¢–û–í (–ì–õ–ê–í–ù–´–ô –≠–ö–†–ê–ù) */
        .chat-list { flex: 1; overflow-y: auto; padding: 15px; }
        .chat-card {
            background: var(--panel); padding: 20px; border-radius: 20px;
            border: 1px solid var(--border); margin-bottom: 15px;
            display: flex; align-items: center; gap: 15px;
        }
        .ava { width: 50px; height: 50px; border-radius: 15px; background: var(--accent); color: #000; display: flex; align-items: center; justify-content: center; font-weight: 900; }

        /* –û–ö–ù–û –ß–ê–¢–ê (–í–´–ï–ó–ñ–ê–ï–¢) */
        #chat-window {
            position: fixed; inset: 0; background: var(--bg); z-index: 500;
            transform: translateX(100%); transition: 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex; flex-direction: column;
        }
        #chat-window.open { transform: translateX(0); }

        #messages { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 10px; padding-bottom: 100px; }
        .msg { max-width: 85%; padding: 12px 16px; border-radius: 18px; font-size: 15px; line-height: 1.4; }
        .msg.in { align-self: flex-start; background: #1a1a1a; border: 1px solid var(--border); }
        .msg.out { align-self: flex-end; background: var(--accent); color: #000; font-weight: 500; }

        /* –í–í–û–î –°–û–û–ë–©–ï–ù–ò–Ø (MOBILE BOTTOM) */
        .input-area {
            position: absolute; bottom: 0; left: 0; right: 0;
            padding: 15px 20px 30px; background: rgba(10, 10, 10, 0.95);
            backdrop-filter: blur(10px); display: flex; gap: 10px;
        }
        .m-field { flex: 1; background: #000; border: 1px solid var(--border); padding: 15px; border-radius: 25px; color: #fff; outline: none; }

        /* –ü–†–ò–í–ï–¢–°–¢–í–ò–ï */
        #welcome-notif {
            position: fixed; top: -100px; left: 20px; right: 20px;
            background: var(--accent); color: #000; padding: 15px;
            border-radius: 15px; text-align: center; font-weight: 900;
            z-index: 2000; transition: 0.5s; box-shadow: 0 10px 30px rgba(0, 242, 255, 0.3);
        }
        #welcome-notif.active { top: 20px; }
    </style>
</head>
<body>

    <div class="grid"></div>

    <div id="auth-screen">
        <div class="auth-card">
            <h1 style="color: var(--accent); letter-spacing: 5px; margin-bottom: 30px;">ULTRA</h1>
            <input type="text" id="m-name" class="input-m" placeholder="–í–ê–® –ù–ò–ö–ù–ï–ô–ú">
            <button class="btn-m" onclick="initMobile()">–ü–û–î–ö–õ–Æ–ß–ò–¢–¨–°–Ø</button>
        </div>
    </div>

    <div id="welcome-notif">–°–ò–°–¢–ï–ú–ê –ê–ö–¢–ò–í–ò–†–û–í–ê–ù–ê</div>

    <div id="app">
        <header class="header">
            <div style="font-weight: 900; letter-spacing: 2px;">ULTRA CORE</div>
            <div onclick="toggleSettings()" style="font-size: 20px;">‚öôÔ∏è</div>
        </header>

        <div class="chat-list">
            <div style="font-size: 10px; opacity: 0.5; letter-spacing: 2px; margin-bottom: 20px;">–î–û–°–¢–£–ü–ù–´–ï –ö–ê–ù–ê–õ–´</div>
            <div class="chat-card" onclick="openChat()">
                <div class="ava">#</div>
                <div style="flex: 1;">
                    <div style="font-weight: 700;">MAIN_STREAM</div>
                    <div style="font-size: 12px; color: var(--accent);"><span class="status-dot"></span> <span id="online-count">0</span> Online</div>
                </div>
                <div style="opacity: 0.3;">‚ùØ</div>
            </div>
        </div>
    </div>

    <div id="chat-window">
        <header class="header">
            <div onclick="closeChat()" style="font-size: 24px; color: var(--accent);">‚ùÆ</div>
            <div style="font-weight: 700;"># MAIN_STREAM</div>
            <div style="width: 24px;"></div>
        </header>

        <div id="messages"></div>

        <form class="input-area" id="m-form">
            <input type="text" id="msg-input" class="m-field" placeholder="–°–æ–æ–±—â–µ–Ω–∏–µ..." autocomplete="off">
            <button type="submit" style="background: var(--accent); border: none; width: 50px; height: 50px; border-radius: 50%; font-size: 20px; cursor: pointer;">üöÄ</button>
        </form>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        let myNick = "";

        function initMobile() {
            const n = document.getElementById('m-name').value;
            if(!n) return;
            myNick = n;

            // –ê–Ω–∏–º–∞—Ü–∏—è –≤—Ö–æ–¥–∞
            document.getElementById('auth-screen').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('auth-screen').style.display = 'none';
                document.getElementById('app').style.opacity = '1';
                
                // –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ —Å–≤–µ—Ä—Ö—É
                const notif = document.getElementById('welcome-notif');
                notif.innerText = `–î–û–ë–†–û –ü–û–ñ–ê–õ–û–í–ê–¢–¨, ${myNick.toUpperCase()}`;
                notif.classList.add('active');
                setTimeout(() => notif.classList.remove('active'), 3000);
                
                socket.emit('authenticate', { username: myNick });
            }, 500);
        }

        function openChat() { document.getElementById('chat-window').classList.add('open'); }
        function closeChat() { document.getElementById('chat-window').classList.remove('open'); }

        socket.on('update_online', count => {
            document.getElementById('online-count').innerText = count;
        });

        document.getElementById('m-form').onsubmit = (e) => {
            e.preventDefault();
            const inp = document.getElementById('msg-input');
            if(inp.value) {
                socket.emit('message', { text: inp.value });
                inp.value = '';
            }
        };

        socket.on('message', m => {
            const wrap = document.getElementById('messages');
            const isMe = m.name === myNick;
            const div = document.createElement('div');
            div.className = `msg ${isMe ? 'out' : 'in'}`;
            div.innerHTML = `
                ${!isMe ? `<div style="font-size:10px; color:var(--accent); margin-bottom:4px;">${m.name}</div>` : ''}
                ${m.text}
            `;
            wrap.appendChild(div);
            wrap.scrollTop = wrap.scrollHeight;
        });
    </script>
</body>
</html>
