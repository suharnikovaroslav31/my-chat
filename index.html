<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Speeky | Next Gen</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --accent: #9d50ff;
            --accent-light: #bc8aff;
            --bg: #050505;
            --island-bg: rgba(15, 15, 20, 0.95);
            --glass: rgba(255, 255, 255, 0.03);
            --border: rgba(255, 255, 255, 0.08);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Inter', sans-serif; }
        body { background: var(--bg); color: #fff; height: 100vh; overflow: hidden; }

        /* --- –≠–ö–†–ê–ù –†–ï–ì–ò–°–¢–†–ê–¶–ò–ò (–ü–û–ß–¢–ê) --- */
        #auth-layer {
            position: fixed; inset: 0; z-index: 5000; background: var(--bg);
            display: flex; align-items: center; justify-content: center; padding: 20px;
        }
        .auth-card {
            width: 100%; max-width: 360px; background: var(--glass); 
            padding: 40px 30px; border-radius: 35px; border: 1px solid var(--border);
            backdrop-filter: blur(20px); text-align: center;
        }
        .auth-card h2 { font-size: 28px; margin-bottom: 10px; font-weight: 800; }
        .auth-card p { font-size: 14px; opacity: 0.5; margin-bottom: 30px; }
        .input-group { margin-bottom: 15px; text-align: left; }
        .input-group label { font-size: 11px; text-transform: uppercase; letter-spacing: 1px; opacity: 0.4; margin-left: 10px; }
        .auth-input {
            width: 100%; background: rgba(255,255,255,0.05); border: 1px solid var(--border);
            padding: 16px; border-radius: 18px; color: #fff; outline: none; transition: 0.3s;
        }
        .auth-input:focus { border-color: var(--accent); background: rgba(157, 80, 255, 0.05); }
        .auth-btn {
            width: 100%; padding: 18px; background: var(--accent); border: none;
            border-radius: 18px; color: #fff; font-weight: 700; cursor: pointer; margin-top: 10px;
        }

        /* --- –ì–õ–ê–í–ù–´–ô –ò–ù–¢–ï–†–§–ï–ô–° --- */
        #app { display: none; height: 100vh; flex-direction: column; opacity: 0; transition: 0.5s; }
        
        .header { padding: 20px; display: flex; align-items: center; justify-content: space-between; border-bottom: 1px solid var(--border); }
        .view-section { flex: 1; overflow-y: auto; padding: 20px; display: none; }
        .view-section.active { display: flex; flex-direction: column; }

        /* –ß–ê–¢ */
        #chat-content { flex: 1; overflow-y: auto; display: flex; flex-direction: column; gap: 12px; }
        .msg { max-width: 80%; padding: 14px 18px; border-radius: 22px; font-size: 15px; position: relative; }
        .msg.in { background: var(--glass); border: 1px solid var(--border); align-self: flex-start; }
        .msg.out { background: var(--accent); align-self: flex-end; box-shadow: 0 10px 20px rgba(157, 80, 255, 0.2); }
        .msg-sender { font-size: 10px; font-weight: 800; color: var(--accent-light); margin-bottom: 4px; }

        /* –ü–û–õ–ï –í–í–û–î–ê */
        .input-area { padding: 15px 20px; display: flex; gap: 10px; background: rgba(0,0,0,0.2); }
        .m-field { flex: 1; background: var(--glass); border: 1px solid var(--border); padding: 14px 20px; border-radius: 25px; color: #fff; outline: none; }

        /* --- DYNAMIC ISLAND (–û–°–¢–†–û–í–û–ö) --- */
        .island-wrap {
            position: fixed; bottom: 25px; left: 50%; transform: translateX(-50%);
            width: 90%; max-width: 380px; z-index: 4000;
        }
        .island {
            background: var(--island-bg); border: 1px solid var(--border);
            border-radius: 35px; padding: 12px; display: flex;
            justify-content: space-around; align-items: center;
            backdrop-filter: blur(30px); box-shadow: 0 20px 40px rgba(0,0,0,0.6);
        }
        .nav-icon { font-size: 22px; cursor: pointer; opacity: 0.4; transition: 0.3s; padding: 10px; border-radius: 50%; }
        .nav-icon.active { opacity: 1; color: var(--accent); background: rgba(255,255,255,0.05); }

        /* –°–ü–ò–°–ö–ò (–ö–û–ù–¢–ê–ö–¢–´ / –ù–ê–°–¢–†–û–ô–ö–ò) */
        .list-item {
            padding: 18px; background: var(--glass); border: 1px solid var(--border);
            border-radius: 22px; margin-bottom: 10px; display: flex; align-items: center; gap: 15px;
        }
        .status { width: 10px; height: 10px; border-radius: 50%; background: #444; }
        .status.online { background: #0f8; box-shadow: 0 0 10px #0f8; }

    </style>
</head>
<body>

    <div id="auth-layer">
        <div class="auth-card">
            <h2>–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç</h2>
            <p>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –±—É–¥—É—â–µ–µ Speeky</p>
            
            <div class="input-group">
                <label>Email Address</label>
                <input type="email" id="auth-email" class="auth-input" placeholder="name@example.com">
            </div>
            <div class="input-group">
                <label>Nickname</label>
                <input type="text" id="auth-nick" class="auth-input" placeholder="@nickname">
            </div>
            <div class="input-group">
                <label>Password</label>
                <input type="password" id="auth-pass" class="auth-input" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
            </div>

            <button class="auth-btn" onclick="register()">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
        </div>
    </div>

    <div id="app">
        <header class="header">
            <h1 id="view-title"># –û—Å–Ω–æ–≤–Ω–æ–π —á–∞—Ç</h1>
            <div style="font-size: 10px; opacity: 0.5;">ID: <span id="user-id">...</span></div>
        </header>

        <div id="view-chat" class="view-section active">
            <div id="chat-content"></div>
            <div class="input-area">
                <input type="text" id="msg-input" class="m-field" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ —á—Ç–æ-–Ω–∏–±—É–¥—å...">
                <button onclick="send()" style="background:var(--accent); border:none; padding:10px 20px; border-radius:20px; color:#fff; font-weight:800;">–û–¢–ü–†–ê–í–ò–¢–¨</button>
            </div>
        </div>

        <div id="view-contacts" class="view-section">
            <h2 style="margin-bottom:20px">–í–∞—à–∏ —Å–≤—è–∑–∏</h2>
            <div class="list-item">
                <div class="status online"></div>
                <div><b>–Ø—Ä–æ—Å–ª–∞–≤</b><br><small style="opacity:0.5">–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ —è–¥—Ä–∞</small></div>
            </div>
            <div class="list-item">
                <div class="status"></div>
                <div><b>Support_Bot</b><br><small style="opacity:0.5">–í–Ω–µ —Å–µ—Ç–∏</small></div>
            </div>
        </div>

        <div id="view-create" class="view-section">
            <h2 style="margin-bottom:20px">–°–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ</h2>
            <div class="list-item" onclick="alert('–§—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ')">
                <div style="font-size:24px">üë•</div>
                <div><b>–ù–æ–≤–∞—è –≥—Ä—É–ø–ø–∞</b><br><small style="opacity:0.5">–î–æ 5000 —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</small></div>
            </div>
            <div class="list-item" onclick="alert('–§—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ')">
                <div style="font-size:24px">üì¢</div>
                <div><b>–ù–æ–≤—ã–π –∫–∞–Ω–∞–ª</b><br><small style="opacity:0.5">–ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤</small></div>
            </div>
        </div>

        <div id="view-settings" class="view-section">
            <h2 style="margin-bottom:20px">–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è</h2>
            <div class="list-item">
                <div style="flex:1"><b>–î–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è</b></div>
                <input type="checkbox">
            </div>
            <div class="list-item">
                <div style="flex:1"><b>–°–∫–≤–æ–∑–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ (E2E)</b></div>
                <input type="checkbox" checked disabled>
            </div>
            <div class="list-item">
                <div style="flex:1"><b>–°–∫—Ä—ã–≤–∞—Ç—å –æ–Ω–ª–∞–π–Ω-—Å—Ç–∞—Ç—É—Å</b></div>
                <input type="checkbox">
            </div>
            <div class="list-item" style="border-color: #ff4444; color: #ff4444;" onclick="location.reload()">
                <b>–í—ã–π—Ç–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã</b>
            </div>
        </div>

        <div class="island-wrap">
            <div class="island">
                <div class="nav-icon active" onclick="switchView('chat', this)">üí¨</div>
                <div class="nav-icon" onclick="switchView('contacts', this)">üë§</div>
                <div class="nav-icon" onclick="switchView('create', this)">‚äï</div>
                <div class="nav-icon" onclick="switchView('settings', this)">‚öôÔ∏è</div>
            </div>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        let myNick = "";

        // –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø
        function register() {
            const email = document.getElementById('auth-email').value;
            const nick = document.getElementById('auth-nick').value;
            const pass = document.getElementById('auth-pass').value;

            if(!email.includes('@') || nick.length < 3) {
                alert("–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é –ø–æ—á—Ç—É –∏ –Ω–∏–∫!");
                return;
            }

            myNick = nick;
            document.getElementById('auth-layer').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('auth-layer').style.display = 'none';
                const app = document.getElementById('app');
                app.style.display = 'flex';
                setTimeout(() => app.style.opacity = '1', 50);
                
                document.getElementById('user-id').innerText = Math.random().toString(16).slice(2, 8).toUpperCase();
                socket.emit('authenticate', { username: myNick });
            }, 500);
        }

        // –ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ò–ï –ò–ù–¢–ï–†–§–ï–ô–°–ê (SPA –õ–û–ì–ò–ö–ê)
        function switchView(viewName, el) {
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å–æ –≤—Å–µ—Ö –∏–∫–æ–Ω–æ–∫ –∏ —Å–µ–∫—Ü–∏–π
            document.querySelectorAll('.view-section').forEach(v => v.classList.remove('active'));
            document.querySelectorAll('.nav-icon').forEach(i => i.classList.remove('active'));
            
            // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –Ω—É–∂–Ω—É—é
            document.getElementById('view-' + viewName).classList.add('active');
            el.classList.add('active');

            // –ú–µ–Ω—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫
            const titles = { chat: '# –û—Å–Ω–æ–≤–Ω–æ–π —á–∞—Ç', contacts: '–ö–æ–Ω—Ç–∞–∫—Ç—ã', create: '–°–æ–∑–¥–∞–Ω–∏–µ', settings: '–ù–∞—Å—Ç—Ä–æ–π–∫–∏' };
            document.getElementById('view-title').innerText = titles[viewName];
        }

        // –†–ê–ë–û–¢–ê –° –°–û–û–ë–©–ï–ù–ò–Ø–ú–ò (SOCKET.IO)
        function send() {
            const inp = document.getElementById('msg-input');
            if(inp.value.trim()) {
                socket.emit('message', { text: inp.value });
                inp.value = '';
            }
        }

        // –°–ª—É—à–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –í–°–ï–• –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        socket.on('message', m => {
            const chat = document.getElementById('chat-content');
            const isMe = m.name === myNick;
            const div = document.createElement('div');
            div.className = `msg ${isMe ? 'out' : 'in'}`;
            div.innerHTML = `
                ${!isMe ? `<div class="msg-sender">${m.name}</div>` : ''}
                ${m.text}
            `;
            chat.appendChild(div);
            chat.scrollTop = chat.scrollHeight;
        });

        // –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–æ Enter
        document.getElementById('msg-input').onkeypress = (e) => { if(e.key === 'Enter') send(); };
    </script>
</body>
</html>
